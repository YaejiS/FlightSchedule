{% extends "header.html" %}

{% block content %}

<div class="row">
    <div class="col">
        <form action="/" class="form-inline my-2 my-lg-0" method="POST">
            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-info">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <h3>Book your flight</h3>
            <div class="group-fields">
                <label for="currentTime">Today's date and time: </label>
                <input id="currentTime" />
            </div>

            {{ form.csrf_token }}
            {{ form.originplace(class="form-control", placeholder="From") }}
            {{ form.destinationplace(class="form-control", placeholder="To") }}
            <div class="group-fields clearfix">
                {{ form.outboundpartialdate(class="form-control", placeholder="Date") }}
            </div>
            <div class="group-fields clearfix">
                {{ form.returndate(class="form-control", placeholder="Return Date")}}
            </div>

            {{ form.submit(class="btn btn-outline-success") }}
        </form>
    </div>
    <div class="col">
        <h2>Please use the search bar to search for flights! Then you can save them to your schedule</h2>
    </div>
</div>

<script type="text/javascript">
    $(function () {
        
        var today = new Date(),
        tomorrow = new Date(new Date().getTime() + 24 * 60 * 60 * 1000);

        $("#currentTime").igDateEditor({
            dateInputFormat: "dateTime",
            value: new Date(),
            dataMode: "date",
            readOnly: true
        });

        $("#outboundpartialdate").igDatePicker({
            dateInputFormat: "yyyy-MM-dd",
            value: today,
            regional: "en-US",
            dataMode: "date",
            datepickerOptions: {
                minDate: today
                    },
            valueChanged: function (evt, ui) {
                if (ui.newValue instanceof Date) {
                    var nextDay = new Date(ui.newValue.getTime() + 24 * 60 * 60 * 1000);
                    var currentValue = $("#return").igDatePicker("option", "value");
                    if (currentValue.getTime() > nextDay.getTime()) {
                        $("#return").igDatePicker("option", "datepickerOptions", {
                            minDate: nextDay
                        }).igDatePicker("option", "value", nextDay)
                    } else {
                        $("#return").igDatePicker("option", "value", nextDay).igDatePicker("option", "datepickerOptions", {
                            minDate: nextDay
                        })
                    }
                }
             }
        });
        $("#returndate").igDatePicker({
            value: tomorrow,
            dateInputFormat: "yyyy-MM-dd",
            regional: "en-US",
            dataMode: "date",
                datepickerOptions: {
                    minDate: tomorrow,
                    numberOfMonths: [1, 2]
                }
        });
    });
</script>
{% endblock %}